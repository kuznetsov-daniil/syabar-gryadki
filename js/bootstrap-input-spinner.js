!function(t){"use strict";function n(t,n){t.addEventListener("mouseup",function(t){n(t)}),t.addEventListener("touchend",function(t){n(t)}),t.addEventListener("keyup",function(t){32===t.keyCode&&(o=!1,n(t))})}function e(t,n){t.addEventListener("mousedown",function(t){t.preventDefault(),n(t)}),t.addEventListener("touchstart",function(t){t.cancelable&&t.preventDefault(),n(t)}),t.addEventListener("keydown",function(t){32!==t.keyCode||o||(o=!0,n(t))})}var o=!1,a=t.fn.val;t.fn.val=function(t){if(arguments.length>=1&&this[0]&&this[0]["bootstrap-input-spinner"]&&this[0].setValue){var n=this[0];setTimeout(function(){n.setValue(t)})}return a.apply(this,arguments)},t.fn.InputSpinner=t.fn.inputSpinner=function(o){var a={decrementButton:"<strong>-</strong>",incrementButton:"<strong>+</strong>",groupClass:"",buttonsClass:"btn-outline-secondary",buttonsWidth:"2.5rem",textAlign:"center",autoDelay:500,autoInterval:100,boostThreshold:10,boostMultiplier:"auto",locale:null};for(var r in o)a[r]=o[r];var i='<div class="input-group '+a.groupClass+'"><div class="input-group-prepend"><button style="min-width: '+a.buttonsWidth+'" class="btn btn-decrement '+a.buttonsClass+'" type="button">'+a.decrementButton+'</button></div><input type="text" style="text-align: '+a.textAlign+'" class="form-control"/><div class="input-group-append"><button style="min-width: '+a.buttonsWidth+'" class="btn btn-increment '+a.buttonsClass+'" type="button">'+a.incrementButton+"</button></div></div>",u=a.locale||navigator.language||"en-US";this.each(function(){function o(t,n){void 0===n&&(n=!0),isNaN(t)||""===t?(f[0].value="",n&&(E[0].value=""),D=0):(t=parseFloat(t),t=Math.min(Math.max(t,w),F),t=Math.round(t*Math.pow(10,N))/Math.pow(10,N),f[0].value=t,n&&(E[0].value=C.format(t)),D=t)}function r(t,n){n&&setTimeout(function(){var e;"function"==typeof Event?e=new Event(n,{bubbles:!0}):(e=document.createEvent("Event"),e.initEvent(n,!0,!0)),t[0].dispatchEvent(e)})}function s(t){E[0].disabled||(p(t),l(),m=setTimeout(function(){v=setInterval(function(){T>a.boostThreshold?b?(p(t*parseInt(g,10)),g<1e8&&(g=1.1*g),I&&(g=Math.min(I,g))):p(t*g):p(t),T++},a.autoInterval)},a.autoDelay))}function p(t){isNaN(D)&&(D=0),o(Math.round(D/t)*t+t),r(f,"input"),r(f,"change")}function l(){T=0,g=g=b?1:a.boostMultiplier,clearTimeout(m),clearTimeout(v)}function c(){E.prop("required",f.prop("required")),E.prop("placeholder",f.prop("placeholder"));var t=f.prop("disabled");E.prop("disabled",t),x.prop("disabled",t),y.prop("disabled",t),t&&l();var n=f.prop("class"),e="";/form-control-sm/g.test(n)?e="input-group-sm":/form-control-lg/g.test(n)&&(e="input-group-lg");var o=n.replace(/form-control(-(sm|lg))?/g,"");h.prop("class","input-group "+e+" "+a.groupClass),E.prop("class","form-control "+o),w=parseFloat(f.prop("min"))||0,F=isNaN(f.prop("max"))||""===f.prop("max")?1/0:parseFloat(f.prop("max")),M=parseFloat(f.prop("step"))||1,I=parseInt(f.attr("data-step-max"))||0;var r=parseInt(f.attr("data-decimals"))||0;N!==r&&(N=r,C=new Intl.NumberFormat(u,{minimumFractionDigits:N,maximumFractionDigits:N}))}function d(t){var n=new Intl.NumberFormat(u),e=n.format(1111).replace(/1/g,""),o=n.format(1.1).replace(/1/g,"");return parseFloat(t.replace(new RegExp("\\"+e,"g"),"").replace(new RegExp("\\"+o),"."))}var f=t(this);f[0]["bootstrap-input-spinner"]=!0,f.hide();var m=null,v=null,b="auto"===a.boostMultiplier,g=b?1:a.boostMultiplier,h=t(i),y=h.find(".btn-decrement"),x=h.find(".btn-increment"),E=h.find("input"),w=null,F=null,M=null,I=null,N=null;c();var C=new Intl.NumberFormat(u,{minimumFractionDigits:N,maximumFractionDigits:N}),D=parseFloat(f[0].value),T=0,L=f.attr("data-prefix")||"",k=f.attr("data-suffix")||"";if(L){var B=t('<span class="input-group-text">'+L+"</span>");h.find(".input-group-prepend").append(B)}if(k){var S=t('<span class="input-group-text">'+k+"</span>");h.find(".input-group-append").prepend(S)}f[0].setValue=function(t){o(t)};var V=new MutationObserver(function(){c(),o(D,!0)});V.observe(f[0],{attributes:!0}),f.after(h),o(D),E.on("paste input change focusout",function(t){var n=E[0].value,e="focusout"===t.type;n=d(n),o(n,e),r(f,t.type)}),e(y[0],function(){s(-M)}),e(x[0],function(){s(M)}),n(document.body,function(){l()})})}}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJvb3RzdHJhcC1pbnB1dC1zcGlubmVyLmpzIl0sIm5hbWVzIjpbIiQiLCJvblBvaW50ZXJVcCIsImVsZW1lbnQiLCJjYWxsYmFjayIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwia2V5Q29kZSIsInNwYWNlUHJlc3NlZCIsIm9uUG9pbnRlckRvd24iLCJwcmV2ZW50RGVmYXVsdCIsImNhbmNlbGFibGUiLCJvcmlnaW5hbFZhbCIsImZuIiwidmFsIiwidmFsdWUiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ0aGlzIiwic2V0VmFsdWUiLCJzZXRUaW1lb3V0IiwiYXBwbHkiLCJJbnB1dFNwaW5uZXIiLCJpbnB1dFNwaW5uZXIiLCJvcHRpb25zIiwiY29uZmlnIiwiZGVjcmVtZW50QnV0dG9uIiwiaW5jcmVtZW50QnV0dG9uIiwiZ3JvdXBDbGFzcyIsImJ1dHRvbnNDbGFzcyIsImJ1dHRvbnNXaWR0aCIsInRleHRBbGlnbiIsImF1dG9EZWxheSIsImF1dG9JbnRlcnZhbCIsImJvb3N0VGhyZXNob2xkIiwiYm9vc3RNdWx0aXBsaWVyIiwibG9jYWxlIiwib3B0aW9uIiwiaHRtbCIsIm5hdmlnYXRvciIsImxhbmd1YWdlIiwiZWFjaCIsIm5ld1ZhbHVlIiwidXBkYXRlSW5wdXQiLCJ1bmRlZmluZWQiLCJpc05hTiIsIiRvcmlnaW5hbCIsIiRpbnB1dCIsInBhcnNlRmxvYXQiLCJNYXRoIiwibWluIiwibWF4Iiwicm91bmQiLCJwb3ciLCJkZWNpbWFscyIsIm51bWJlckZvcm1hdCIsImZvcm1hdCIsImRpc3BhdGNoRXZlbnQiLCIkZWxlbWVudCIsInR5cGUiLCJldmVudCIsIkV2ZW50IiwiYnViYmxlcyIsImRvY3VtZW50IiwiY3JlYXRlRXZlbnQiLCJpbml0RXZlbnQiLCJzdGVwSGFuZGxpbmciLCJzdGVwIiwiZGlzYWJsZWQiLCJjYWxjU3RlcCIsInJlc2V0VGltZXIiLCJhdXRvRGVsYXlIYW5kbGVyIiwiYXV0b0ludGVydmFsSGFuZGxlciIsInNldEludGVydmFsIiwiYm9vc3RTdGVwc0NvdW50IiwiYXV0b011bHRpcGxpZXIiLCJwYXJzZUludCIsInN0ZXBNYXgiLCJjbGVhclRpbWVvdXQiLCJ1cGRhdGVBdHRyaWJ1dGVzIiwicHJvcCIsIiRidXR0b25JbmNyZW1lbnQiLCIkYnV0dG9uRGVjcmVtZW50Iiwib3JpZ2luYWxDbGFzcyIsInRlc3QiLCJpbnB1dENsYXNzIiwicmVwbGFjZSIsIiRpbnB1dEdyb3VwIiwiSW5maW5pdHkiLCJhdHRyIiwibmV3RGVjaW1hbHMiLCJJbnRsIiwiTnVtYmVyRm9ybWF0IiwibWluaW11bUZyYWN0aW9uRGlnaXRzIiwibWF4aW11bUZyYWN0aW9uRGlnaXRzIiwicGFyc2VMb2NhbGVOdW1iZXIiLCJzdHJpbmdOdW1iZXIiLCJ0aG91c2FuZFNlcGFyYXRvciIsImRlY2ltYWxTZXBhcmF0b3IiLCJSZWdFeHAiLCJoaWRlIiwiZmluZCIsInByZWZpeCIsInN1ZmZpeCIsInByZWZpeEVsZW1lbnQiLCJhcHBlbmQiLCJzdWZmaXhFbGVtZW50IiwicHJlcGVuZCIsIm9ic2VydmVyIiwiTXV0YXRpb25PYnNlcnZlciIsIm9ic2VydmUiLCJhdHRyaWJ1dGVzIiwiYWZ0ZXIiLCJvbiIsImZvY3VzT3V0IiwiYm9keSIsImpRdWVyeSJdLCJtYXBwaW5ncyI6IkNBTUUsU0FBVUEsR0FDUixZQTZQQSxTQUFTQyxHQUFZQyxFQUFTQyxHQUMxQkQsRUFBUUUsaUJBQWlCLFVBQVcsU0FBVUMsR0FDMUNGLEVBQVNFLEtBRWJILEVBQVFFLGlCQUFpQixXQUFZLFNBQVVDLEdBQzNDRixFQUFTRSxLQUViSCxFQUFRRSxpQkFBaUIsUUFBUyxTQUFVQyxHQUN0QixLQUFkQSxFQUFFQyxVQUNGQyxHQUFlLEVBQ2ZKLEVBQVNFLE1BS3JCLFFBQVNHLEdBQWNOLEVBQVNDLEdBQzVCRCxFQUFRRSxpQkFBaUIsWUFBYSxTQUFVQyxHQUM1Q0EsRUFBRUksaUJBQ0ZOLEVBQVNFLEtBRWJILEVBQVFFLGlCQUFpQixhQUFjLFNBQVVDLEdBQ3pDQSxFQUFFSyxZQUNGTCxF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QUFVdUIsR0FDOUJ2QixFQUFTdUIsR0FHYixJQUFJa0UsR0FBVyxHQUFJQyxrQkFBaUIsV0FDaEM5QixJQUNBNUQsRUFBU0osR0FBTyxJQUVwQjZGLEdBQVNFLFFBQVFoRSxFQUFVLElBQUtpRSxZQUFZLElBRTVDakUsRUFBVWtFLE1BQU16QixHQUVoQnBFLEVBQVNKLEdBRVRnQyxFQUFPa0UsR0FBRyw4QkFBK0IsU0FBVXJELEdBQy9DLEdBQUlsQixHQUFXSyxFQUFPLEdBQUdoQyxNQUNyQm1HLEVBQTBCLGFBQWZ0RCxFQUFNRCxJQUNyQmpCLEdBQVdxRCxFQUFrQnJELEdBQzdCdkIsRUFBU3VCLEVBQVV3RSxHQUNuQnpELEVBQWNYLEVBQVdjLEVBQU1ELFFBR25DbEQsRUFBY3lFLEVBQWlCLEdBQUksV0FDL0JoQixHQUFjQyxLQUVsQjFELEVBQWN3RSxFQUFpQixHQUFJLFdBQy9CZixFQUFhQyxLQUVqQmpFLEVBQVk2RCxTQUFTb0QsS0FBTSxXQUN2QjdDLFVBd0tkOEMiLCJmaWxlIjoiYm9vdHN0cmFwLWlucHV0LXNwaW5uZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEF1dGhvciBhbmQgY29weXJpZ2h0OiBTdGVmYW4gSGFhY2sgKGh0dHBzOi8vc2hhYWNrLmNvbSlcbiAqIFJlcG9zaXRvcnk6IGh0dHBzOi8vZ2l0aHViLmNvbS9zaGFhY2svYm9vdHN0cmFwLWlucHV0LXNwaW5uZXJcbiAqIExpY2Vuc2U6IE1JVCwgc2VlIGZpbGUgJ0xJQ0VOU0UnXG4gKi9cblxuOyhmdW5jdGlvbiAoJCkge1xuICAgIFwidXNlIHN0cmljdFwiXG5cbiAgICB2YXIgc3BhY2VQcmVzc2VkID0gZmFsc2VcbiAgICB2YXIgb3JpZ2luYWxWYWwgPSAkLmZuLnZhbFxuICAgICQuZm4udmFsID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID49IDEpIHtcbiAgICAgICAgICAgIGlmICh0aGlzWzBdICYmIHRoaXNbMF1bXCJib290c3RyYXAtaW5wdXQtc3Bpbm5lclwiXSAmJiB0aGlzWzBdLnNldFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzWzBdO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnNldFZhbHVlKHZhbHVlKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9yaWdpbmFsVmFsLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcbiAgICB9XG5cbiAgICAkLmZuLklucHV0U3Bpbm5lciA9ICQuZm4uaW5wdXRTcGlubmVyID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcblxuICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgZGVjcmVtZW50QnV0dG9uOiBcIjxzdHJvbmc+LTwvc3Ryb25nPlwiLCAvLyBidXR0b24gdGV4dFxuICAgICAgICAgICAgaW5jcmVtZW50QnV0dG9uOiBcIjxzdHJvbmc+Kzwvc3Ryb25nPlwiLCAvLyAuLlxuICAgICAgICAgICAgZ3JvdXBDbGFzczogXCJcIiwgLy8gY3NzIGNsYXNzIG9mIHRoZSByZXN1bHRpbmcgaW5wdXQtZ3JvdXBcbiAgICAgICAgICAgIGJ1dHRvbnNDbGFzczogXCJidG4tb3V0bGluZS1zZWNvbmRhcnlcIixcbiAgICAgICAgICAgIGJ1dHRvbnNXaWR0aDogXCIyLjVyZW1cIixcbiAgICAgICAgICAgIHRleHRBbGlnbjogXCJjZW50ZXJcIixcbiAgICAgICAgICAgIGF1dG9EZWxheTogNTAwLCAvLyBtcyBob2xkaW5nIGJlZm9yZSBhdXRvIHZhbHVlIGNoYW5nZVxuICAgICAgICAgICAgYXV0b0ludGVydmFsOiAxMDAsIC8vIHNwZWVkIG9mIGF1dG8gdmFsdWUgY2hhbmdlXG4gICAgICAgICAgICBib29zdFRocmVzaG9sZDogMTAsIC8vIGJvb3N0IGFmdGVyIHRoZXNlIHN0ZXBzXG4gICAgICAgICAgICBib29zdE11bHRpcGxpZXI6IFwiYXV0b1wiLCAvLyB5b3UgY2FuIGFsc28gc2V0IGEgY29uc3RhbnQgbnVtYmVyIGFzIG11bHRpcGxpZXJcbiAgICAgICAgICAgIGxvY2FsZTogbnVsbCAvLyB0aGUgbG9jYWxlIGZvciBudW1iZXIgcmVuZGVyaW5nOyBpZiBudWxsLCB0aGUgYnJvd3NlcnMgbGFuZ3VhZ2UgaXMgdXNlZFxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIG9wdGlvbiBpbiBvcHRpb25zKSB7XG4gICAgICAgICAgICBjb25maWdbb3B0aW9uXSA9IG9wdGlvbnNbb3B0aW9uXVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGh0bWwgPSAnPGRpdiBjbGFzcz1cImlucHV0LWdyb3VwICcgKyBjb25maWcuZ3JvdXBDbGFzcyArICdcIj4nICtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaW5wdXQtZ3JvdXAtcHJlcGVuZFwiPicgK1xuICAgICAgICAgICAgJzxidXR0b24gc3R5bGU9XCJtaW4td2lkdGg6ICcgKyBjb25maWcuYnV0dG9uc1dpZHRoICsgJ1wiIGNsYXNzPVwiYnRuIGJ0bi1kZWNyZW1lbnQgJyArIGNvbmZpZy5idXR0b25zQ2xhc3MgKyAnXCIgdHlwZT1cImJ1dHRvblwiPicgKyBjb25maWcuZGVjcmVtZW50QnV0dG9uICsgJzwvYnV0dG9uPicgK1xuICAgICAgICAgICAgJzwvZGl2PicgK1xuICAgICAgICAgICAgJzxpbnB1dCB0eXBlPVwidGV4dFwiIHN0eWxlPVwidGV4dC1hbGlnbjogJyArIGNvbmZpZy50ZXh0QWxpZ24gKyAnXCIgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIi8+JyArXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cImlucHV0LWdyb3VwLWFwcGVuZFwiPicgK1xuICAgICAgICAgICAgJzxidXR0b24gc3R5bGU9XCJtaW4td2lkdGg6ICcgKyBjb25maWcuYnV0dG9uc1dpZHRoICsgJ1wiIGNsYXNzPVwiYnRuIGJ0bi1pbmNyZW1lbnQgJyArIGNvbmZpZy5idXR0b25zQ2xhc3MgKyAnXCIgdHlwZT1cImJ1dHRvblwiPicgKyBjb25maWcuaW5jcmVtZW50QnV0dG9uICsgJzwvYnV0dG9uPicgK1xuICAgICAgICAgICAgJzwvZGl2PicgK1xuICAgICAgICAgICAgJzwvZGl2PidcblxuICAgICAgICB2YXIgbG9jYWxlID0gY29uZmlnLmxvY2FsZSB8fCBuYXZpZ2F0b3IubGFuZ3VhZ2UgfHwgXCJlbi1VU1wiXG5cbiAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgdmFyICRvcmlnaW5hbCA9ICQodGhpcylcbiAgICAgICAgICAgICRvcmlnaW5hbFswXVtcImJvb3RzdHJhcC1pbnB1dC1zcGlubmVyXCJdID0gdHJ1ZVxuICAgICAgICAgICAgJG9yaWdpbmFsLmhpZGUoKVxuXG4gICAgICAgICAgICB2YXIgYXV0b0RlbGF5SGFuZGxlciA9IG51bGxcbiAgICAgICAgICAgIHZhciBhdXRvSW50ZXJ2YWxIYW5kbGVyID0gbnVsbFxuICAgICAgICAgICAgdmFyIGF1dG9NdWx0aXBsaWVyID0gY29uZmlnLmJvb3N0TXVsdGlwbGllciA9PT0gXCJhdXRvXCJcbiAgICAgICAgICAgIHZhciBib29zdE11bHRpcGxpZXIgPSBhdXRvTXVsdGlwbGllciA/IDEgOiBjb25maWcuYm9vc3RNdWx0aXBsaWVyXG5cbiAgICAgICAgICAgIHZhciAkaW5wdXRHcm91cCA9ICQoaHRtbClcbiAgICAgICAgICAgIHZhciAkYnV0dG9uRGVjcmVtZW50ID0gJGlucHV0R3JvdXAuZmluZChcIi5idG4tZGVjcmVtZW50XCIpXG4gICAgICAgICAgICB2YXIgJGJ1dHRvbkluY3JlbWVudCA9ICRpbnB1dEdyb3VwLmZpbmQoXCIuYnRuLWluY3JlbWVudFwiKVxuICAgICAgICAgICAgdmFyICRpbnB1dCA9ICRpbnB1dEdyb3VwLmZpbmQoXCJpbnB1dFwiKVxuXG4gICAgICAgICAgICB2YXIgbWluID0gbnVsbFxuICAgICAgICAgICAgdmFyIG1heCA9IG51bGxcbiAgICAgICAgICAgIHZhciBzdGVwID0gbnVsbFxuICAgICAgICAgICAgdmFyIHN0ZXBNYXggPSBudWxsXG4gICAgICAgICAgICB2YXIgZGVjaW1hbHMgPSBudWxsXG5cbiAgICAgICAgICAgIHVwZGF0ZUF0dHJpYnV0ZXMoKVxuXG4gICAgICAgICAgICB2YXIgbnVtYmVyRm9ybWF0ID0gbmV3IEludGwuTnVtYmVyRm9ybWF0KGxvY2FsZSwge1xuICAgICAgICAgICAgICAgIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogZGVjaW1hbHMsXG4gICAgICAgICAgICAgICAgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiBkZWNpbWFsc1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHBhcnNlRmxvYXQoJG9yaWdpbmFsWzBdLnZhbHVlKVxuICAgICAgICAgICAgdmFyIGJvb3N0U3RlcHNDb3VudCA9IDBcblxuICAgICAgICAgICAgdmFyIHByZWZpeCA9ICRvcmlnaW5hbC5hdHRyKFwiZGF0YS1wcmVmaXhcIikgfHwgXCJcIlxuICAgICAgICAgICAgdmFyIHN1ZmZpeCA9ICRvcmlnaW5hbC5hdHRyKFwiZGF0YS1zdWZmaXhcIikgfHwgXCJcIlxuXG4gICAgICAgICAgICBpZiAocHJlZml4KSB7XG4gICAgICAgICAgICAgICAgdmFyIHByZWZpeEVsZW1lbnQgPSAkKCc8c3BhbiBjbGFzcz1cImlucHV0LWdyb3VwLXRleHRcIj4nICsgcHJlZml4ICsgJzwvc3Bhbj4nKVxuICAgICAgICAgICAgICAgICRpbnB1dEdyb3VwLmZpbmQoXCIuaW5wdXQtZ3JvdXAtcHJlcGVuZFwiKS5hcHBlbmQocHJlZml4RWxlbWVudClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzdWZmaXgpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3VmZml4RWxlbWVudCA9ICQoJzxzcGFuIGNsYXNzPVwiaW5wdXQtZ3JvdXAtdGV4dFwiPicgKyBzdWZmaXggKyAnPC9zcGFuPicpXG4gICAgICAgICAgICAgICAgJGlucHV0R3JvdXAuZmluZChcIi5pbnB1dC1ncm91cC1hcHBlbmRcIikucHJlcGVuZChzdWZmaXhFbGVtZW50KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkb3JpZ2luYWxbMF0uc2V0VmFsdWUgPSBmdW5jdGlvbiAobmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICBzZXRWYWx1ZShuZXdWYWx1ZSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHVwZGF0ZUF0dHJpYnV0ZXMoKVxuICAgICAgICAgICAgICAgIHNldFZhbHVlKHZhbHVlLCB0cnVlKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIG9ic2VydmVyLm9ic2VydmUoJG9yaWdpbmFsWzBdLCB7YXR0cmlidXRlczogdHJ1ZX0pXG5cbiAgICAgICAgICAgICRvcmlnaW5hbC5hZnRlcigkaW5wdXRHcm91cClcblxuICAgICAgICAgICAgc2V0VmFsdWUodmFsdWUpXG5cbiAgICAgICAgICAgICRpbnB1dC5vbihcInBhc3RlIGlucHV0IGNoYW5nZSBmb2N1c291dFwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3VmFsdWUgPSAkaW5wdXRbMF0udmFsdWVcbiAgICAgICAgICAgICAgICB2YXIgZm9jdXNPdXQgPSBldmVudC50eXBlID09PSBcImZvY3Vzb3V0XCJcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IHBhcnNlTG9jYWxlTnVtYmVyKG5ld1ZhbHVlKVxuICAgICAgICAgICAgICAgIHNldFZhbHVlKG5ld1ZhbHVlLCBmb2N1c091dClcbiAgICAgICAgICAgICAgICBkaXNwYXRjaEV2ZW50KCRvcmlnaW5hbCwgZXZlbnQudHlwZSlcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIG9uUG9pbnRlckRvd24oJGJ1dHRvbkRlY3JlbWVudFswXSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHN0ZXBIYW5kbGluZygtc3RlcClcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBvblBvaW50ZXJEb3duKCRidXR0b25JbmNyZW1lbnRbMF0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBzdGVwSGFuZGxpbmcoc3RlcClcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBvblBvaW50ZXJVcChkb2N1bWVudC5ib2R5LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmVzZXRUaW1lcigpXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBzZXRWYWx1ZShuZXdWYWx1ZSwgdXBkYXRlSW5wdXQpIHtcbiAgICAgICAgICAgICAgICBpZiAodXBkYXRlSW5wdXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVJbnB1dCA9IHRydWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKG5ld1ZhbHVlKSB8fCBuZXdWYWx1ZSA9PT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAkb3JpZ2luYWxbMF0udmFsdWUgPSBcIlwiXG4gICAgICAgICAgICAgICAgICAgIGlmICh1cGRhdGVJbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJGlucHV0WzBdLnZhbHVlID0gXCJcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gMFxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gcGFyc2VGbG9hdChuZXdWYWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBNYXRoLm1pbihNYXRoLm1heChuZXdWYWx1ZSwgbWluKSwgbWF4KVxuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IE1hdGgucm91bmQobmV3VmFsdWUgKiBNYXRoLnBvdygxMCwgZGVjaW1hbHMpKSAvIE1hdGgucG93KDEwLCBkZWNpbWFscylcbiAgICAgICAgICAgICAgICAgICAgJG9yaWdpbmFsWzBdLnZhbHVlID0gbmV3VmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVwZGF0ZUlucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkaW5wdXRbMF0udmFsdWUgPSBudW1iZXJGb3JtYXQuZm9ybWF0KG5ld1ZhbHVlKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gbmV3VmFsdWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGRpc3BhdGNoRXZlbnQoJGVsZW1lbnQsIHR5cGUpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBldmVudFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAoRXZlbnQpID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQgPSBuZXcgRXZlbnQodHlwZSwge2J1YmJsZXM6IHRydWV9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsgLy8gSUVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuaW5pdEV2ZW50KHR5cGUsIHRydWUsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAkZWxlbWVudFswXS5kaXNwYXRjaEV2ZW50KGV2ZW50KVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gc3RlcEhhbmRsaW5nKHN0ZXApIHtcbiAgICAgICAgICAgICAgICBpZiAoISRpbnB1dFswXS5kaXNhYmxlZCkge1xuICAgICAgICAgICAgICAgICAgICBjYWxjU3RlcChzdGVwKVxuICAgICAgICAgICAgICAgICAgICByZXNldFRpbWVyKClcbiAgICAgICAgICAgICAgICAgICAgYXV0b0RlbGF5SGFuZGxlciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXV0b0ludGVydmFsSGFuZGxlciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYm9vc3RTdGVwc0NvdW50ID4gY29uZmlnLmJvb3N0VGhyZXNob2xkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdXRvTXVsdGlwbGllcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY1N0ZXAoc3RlcCAqIHBhcnNlSW50KGJvb3N0TXVsdGlwbGllciwgMTApKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJvb3N0TXVsdGlwbGllciA8IDEwMDAwMDAwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb3N0TXVsdGlwbGllciA9IGJvb3N0TXVsdGlwbGllciAqIDEuMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0ZXBNYXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29zdE11bHRpcGxpZXIgPSBNYXRoLm1pbihzdGVwTWF4LCBib29zdE11bHRpcGxpZXIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjU3RlcChzdGVwICogYm9vc3RNdWx0aXBsaWVyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY1N0ZXAoc3RlcClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vc3RTdGVwc0NvdW50KytcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGNvbmZpZy5hdXRvSW50ZXJ2YWwpXG4gICAgICAgICAgICAgICAgICAgIH0sIGNvbmZpZy5hdXRvRGVsYXkpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBjYWxjU3RlcChzdGVwKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IDBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2V0VmFsdWUoTWF0aC5yb3VuZCh2YWx1ZSAvIHN0ZXApICogc3RlcCArIHN0ZXApXG4gICAgICAgICAgICAgICAgZGlzcGF0Y2hFdmVudCgkb3JpZ2luYWwsIFwiaW5wdXRcIilcbiAgICAgICAgICAgICAgICBkaXNwYXRjaEV2ZW50KCRvcmlnaW5hbCwgXCJjaGFuZ2VcIilcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gcmVzZXRUaW1lcigpIHtcbiAgICAgICAgICAgICAgICBib29zdFN0ZXBzQ291bnQgPSAwXG4gICAgICAgICAgICAgICAgYm9vc3RNdWx0aXBsaWVyID0gYm9vc3RNdWx0aXBsaWVyID0gYXV0b011bHRpcGxpZXIgPyAxIDogY29uZmlnLmJvb3N0TXVsdGlwbGllclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChhdXRvRGVsYXlIYW5kbGVyKVxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChhdXRvSW50ZXJ2YWxIYW5kbGVyKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiB1cGRhdGVBdHRyaWJ1dGVzKCkge1xuICAgICAgICAgICAgICAgIC8vIGNvcHkgcHJvcGVydGllcyBmcm9tIG9yaWdpbmFsIHRvIHRoZSBuZXcgaW5wdXRcbiAgICAgICAgICAgICAgICAkaW5wdXQucHJvcChcInJlcXVpcmVkXCIsICRvcmlnaW5hbC5wcm9wKFwicmVxdWlyZWRcIikpXG4gICAgICAgICAgICAgICAgJGlucHV0LnByb3AoXCJwbGFjZWhvbGRlclwiLCAkb3JpZ2luYWwucHJvcChcInBsYWNlaG9sZGVyXCIpKVxuICAgICAgICAgICAgICAgIHZhciBkaXNhYmxlZCA9ICRvcmlnaW5hbC5wcm9wKFwiZGlzYWJsZWRcIilcbiAgICAgICAgICAgICAgICAkaW5wdXQucHJvcChcImRpc2FibGVkXCIsIGRpc2FibGVkKVxuICAgICAgICAgICAgICAgICRidXR0b25JbmNyZW1lbnQucHJvcChcImRpc2FibGVkXCIsIGRpc2FibGVkKVxuICAgICAgICAgICAgICAgICRidXR0b25EZWNyZW1lbnQucHJvcChcImRpc2FibGVkXCIsIGRpc2FibGVkKVxuICAgICAgICAgICAgICAgIGlmIChkaXNhYmxlZCkge1xuICAgICAgICAgICAgICAgICAgICByZXNldFRpbWVyKClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG9yaWdpbmFsQ2xhc3MgPSAkb3JpZ2luYWwucHJvcChcImNsYXNzXCIpXG4gICAgICAgICAgICAgICAgdmFyIGdyb3VwQ2xhc3MgPSBcIlwiXG4gICAgICAgICAgICAgICAgLy8gc2l6aW5nXG4gICAgICAgICAgICAgICAgaWYgKC9mb3JtLWNvbnRyb2wtc20vZy50ZXN0KG9yaWdpbmFsQ2xhc3MpKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwQ2xhc3MgPSBcImlucHV0LWdyb3VwLXNtXCJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKC9mb3JtLWNvbnRyb2wtbGcvZy50ZXN0KG9yaWdpbmFsQ2xhc3MpKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwQ2xhc3MgPSBcImlucHV0LWdyb3VwLWxnXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGlucHV0Q2xhc3MgPSBvcmlnaW5hbENsYXNzLnJlcGxhY2UoL2Zvcm0tY29udHJvbCgtKHNtfGxnKSk/L2csIFwiXCIpXG4gICAgICAgICAgICAgICAgJGlucHV0R3JvdXAucHJvcChcImNsYXNzXCIsIFwiaW5wdXQtZ3JvdXAgXCIgKyBncm91cENsYXNzICsgXCIgXCIgKyBjb25maWcuZ3JvdXBDbGFzcylcbiAgICAgICAgICAgICAgICAkaW5wdXQucHJvcChcImNsYXNzXCIsIFwiZm9ybS1jb250cm9sIFwiICsgaW5wdXRDbGFzcylcblxuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSB0aGUgbWFpbiBhdHRyaWJ1dGVzXG4gICAgICAgICAgICAgICAgbWluID0gcGFyc2VGbG9hdCgkb3JpZ2luYWwucHJvcChcIm1pblwiKSkgfHwgMFxuICAgICAgICAgICAgICAgIG1heCA9IGlzTmFOKCRvcmlnaW5hbC5wcm9wKFwibWF4XCIpKSB8fCAkb3JpZ2luYWwucHJvcChcIm1heFwiKSA9PT0gXCJcIiA/IEluZmluaXR5IDogcGFyc2VGbG9hdCgkb3JpZ2luYWwucHJvcChcIm1heFwiKSlcbiAgICAgICAgICAgICAgICBzdGVwID0gcGFyc2VGbG9hdCgkb3JpZ2luYWwucHJvcChcInN0ZXBcIikpIHx8IDFcbiAgICAgICAgICAgICAgICBzdGVwTWF4ID0gcGFyc2VJbnQoJG9yaWdpbmFsLmF0dHIoXCJkYXRhLXN0ZXAtbWF4XCIpKSB8fCAwXG4gICAgICAgICAgICAgICAgdmFyIG5ld0RlY2ltYWxzID0gcGFyc2VJbnQoJG9yaWdpbmFsLmF0dHIoXCJkYXRhLWRlY2ltYWxzXCIpKSB8fCAwXG4gICAgICAgICAgICAgICAgaWYgKGRlY2ltYWxzICE9PSBuZXdEZWNpbWFscykge1xuICAgICAgICAgICAgICAgICAgICBkZWNpbWFscyA9IG5ld0RlY2ltYWxzXG4gICAgICAgICAgICAgICAgICAgIG51bWJlckZvcm1hdCA9IG5ldyBJbnRsLk51bWJlckZvcm1hdChsb2NhbGUsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogZGVjaW1hbHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhpbXVtRnJhY3Rpb25EaWdpdHM6IGRlY2ltYWxzXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBwYXJzZUxvY2FsZU51bWJlcihzdHJpbmdOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgbnVtYmVyRm9ybWF0ID0gbmV3IEludGwuTnVtYmVyRm9ybWF0KGxvY2FsZSlcbiAgICAgICAgICAgICAgICB2YXIgdGhvdXNhbmRTZXBhcmF0b3IgPSBudW1iZXJGb3JtYXQuZm9ybWF0KDExMTEpLnJlcGxhY2UoLzEvZywgJycpXG4gICAgICAgICAgICAgICAgdmFyIGRlY2ltYWxTZXBhcmF0b3IgPSBudW1iZXJGb3JtYXQuZm9ybWF0KDEuMSkucmVwbGFjZSgvMS9nLCAnJylcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChzdHJpbmdOdW1iZXJcbiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UobmV3IFJlZ0V4cCgnXFxcXCcgKyB0aG91c2FuZFNlcGFyYXRvciwgJ2cnKSwgJycpXG4gICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKG5ldyBSZWdFeHAoJ1xcXFwnICsgZGVjaW1hbFNlcGFyYXRvciksICcuJylcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvblBvaW50ZXJVcChlbGVtZW50LCBjYWxsYmFjaykge1xuICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhlKVxuICAgICAgICB9KVxuICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgY2FsbGJhY2soZSlcbiAgICAgICAgfSlcbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT09IDMyKSB7XG4gICAgICAgICAgICAgICAgc3BhY2VQcmVzc2VkID0gZmFsc2VcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhlKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uUG9pbnRlckRvd24oZWxlbWVudCwgY2FsbGJhY2spIHtcbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgICAgIGNhbGxiYWNrKGUpXG4gICAgICAgIH0pXG4gICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmIChlLmNhbmNlbGFibGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhbGxiYWNrKGUpXG4gICAgICAgIH0pXG4gICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT09IDMyICYmICFzcGFjZVByZXNzZWQpIHtcbiAgICAgICAgICAgICAgICBzcGFjZVByZXNzZWQgPSB0cnVlXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbn0oalF1ZXJ5KSlcbiJdfQ==
